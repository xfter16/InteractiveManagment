<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width" />
	<title>Registration</title>
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
    <script src="user.js"></script>
    <script src="userapi_register.js"></script>
    <script src="regforms.js"></script><!-- printForm(map) -->
    <script>
    	$(function(){
    		var map = new Map([['Имя', 'firstName'], ['Фамилия', 'lastName'], ['Дата рождения', 'birthday'], ['Моб. Телефон', 'phone'],['Адрес', 'address']]);
    		printForm('.reg-form', map);
    	})
    </script>
</head>
<body>
	<h2>Регистрация</h2>
	<form id="register-form" name="userForm">
        <input type="hidden" name="id" value="0" />
		<div class="reg-form"></div>
        <div class="panel-body">
            <button type="submit" class="btn btn-sm btn-primary">Сохранить</button>
            <a id="reset" class="btn btn-sm btn-primary">Сбросить</a>
            <a id="print" class="btn btn-sm btn-primary">Вывести всех</a>
        </div>
    </form>
    <script>
    	$('#register-form').submit(function (e) {
	            e.preventDefault();
	            var user = new User();

	            user.id(this.elements['id'].value);
	            user.firstName(this.elements['firstName'].value);
	            user.lastName(this.elements['lastName'].value);
	            user.birthday(this.elements['birthday'].value);
	            user.phone(this.elements['phone'].value);
	            user.address(this.elements['address'].value);
				CreateUser(user, function(user) {
									console.log(`User ${user.firstName()	} has been posted`);	
								});		    
        });
        

        $("#print").click(function (e) {
        	
            e.preventDefault();
            GetUsers();
        })
 		

        function GetUsers() {
            $.ajax({
                url: "/api/users",
                type: "GET",
                contentType: "application/json",
                success: function (users) {
                    $.each(users, function (index, user) {
                        console.log(user);

                    })
                 }
            });
        }
    </script>
    
</body>
</html>